<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>covid19</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

	<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.3.1/p5.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.3.0/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.3.0/mapbox-gl.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/mappa-mundi@0.0.5"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script src="js/sketch.js"></script>

	<style>
		body {
			margin:0;
			padding:0;
			text-align: center;
			align-items: center;
			background-color: rgb(240,240,240);
		}
		canvas {
			margin:auto;
		}
		#map { float: left; width: 100%; height: 100%; }
	</style>
</head>
<body>
	<nav class="navbar navbar-light mx-auto bg-dark" style="background-color: rgb(121,82,179); margin-bottom: 20px; width: 90%; border-radius: 10px; margin-top: 10px">
	  	<div class="container-fluid">
	    	<a class="navbar-brand mx-auto" href="#" style="color: white; font-size: 40px; font-weight: bold" >
	      		<img src="assets/imagen1.png" alt="" width="70" height="60" class="d-inline-block align-text-top">
	      		Covid-19
	    	</a>
	    	<a class="navbar-brand" href="#" style="color: white; font-size: 20px; margin: 0">
	      		México 2021
	    	</a>
	  	</div>
	</nav>

	<div class="row mx-auto mb-2" style="width: 80%">
		<h1 class="mb-4">Casos Covid-19 Registrados</h1>
      	<div class="col-lg-4">
        	<svg class="bd-placeholder-img rounded-circle" width="90" height="90" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140" preserveAspectRatio="xMidYMid slice" focusable="false"><rect width="100%" height="100%" fill="red"/></svg>

        	<h2 class="text-muted">Confirmados</h2>
        	<p class="card-text"><h1 id="confirmados" style="color: black"></h1></p>
      	</div>
      	<div class="col-lg-4">
        	<svg class="bd-placeholder-img rounded-circle" width="90" height="90" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140" preserveAspectRatio="xMidYMid slice" focusable="false"><rect width="100%" height="100%" fill="green"/></svg>

        	<h2 class="text-muted">Recuperados</h2>
        	<p class="card-text"><h1 id="recuperados" style="color: black"></h1></p>
      	</div>
      	<div class="col-lg-4">
        	<svg class="bd-placeholder-img rounded-circle" width="90" height="90" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140" preserveAspectRatio="xMidYMid slice" focusable="false"><rect width="100%" height="100%" fill="dark"/></svg>

        	<h2 class="text-muted">Defunciones</h2>
        	<p class="card-text" style="color: black"><h1 id="moridos" style="color: black"></h1></p>
      	</div>
    </div>

   	<main style="width: 80%" class="mx-auto">
    	<div class="row row-cols-1 row-cols-md-2 mb-2 text-center">
      		<div class="col">
        		<div class="card mb-4 rounded-3 shadow-sm">
          			<div class="card-header py-3" style="background-color: white; border: none">
            			<h4 class="my-0" style="font-weight: bolder;font-size: 30px;color: black;">Mapa de Casos Confirmados</h4>
          			</div>
          			<div class="card-body" style="height: 70vh">
						<div id="map"></div>
          			</div>
        		</div>
      		</div>
      		<div class="col">
        		<div class="card mb-4 rounded-3 shadow-sm">
          			<div class="card-header py-3" style="background-color: white; border: none">
            			<h4 class="my-0"style="font-weight: bolder;font-size: 30px;color: black;">Grafica</h4>
          			</div>
          			<div class="card-body">
            			<canvas id="myChart" width="370" height="430"></canvas>
          			</div>
        		</div>
      		</div>
      	</div>
  	</main>

  	 <div class="bg-dark text-secondary px-4 py-1 text-center mx-auto" style="width: 90%;border-radius: 10px">
    	<div class="py-2">
      		<h1 class="display-5 fw-bold text-white">Graficación y Multimedia</h1>
      		<div class="col-lg-6 mx-auto">
        		<p class="fs-5 " style="margin: 0">
        			- Guillermo Dominguez Gameros -
        		</p>
        		<p class="fs-5 " style="margin: 0">
        			- Miguel Antonio Aviles Resendiz -
        		</p>
        		<p class="fs-5" style="margin: 0">
        			- Perla Gisell Noriega Sandoval -
        		</p>
      		</div>
    	</div>
  	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
	<script src="path/to/chartjs/dist/chart.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/chart.js@3.3.2/dist/chart.min.js"></script>
	<script type="text/javascript">

    var dataC;
    var dataR;
    var dataF;

    var arrayDias = [];
    var arrayConfirmados = [];
    var arrayRecuperados = [];
    var arrayfallecidos = [];

    const today = new Date();
		const finalDate = new Date(today);
		finalDate.setDate(today.getDate()-1);

 		for (var i = 5; i > 0; i--) {
 			var m = (finalDate.getMonth() +1);
    	var d = (finalDate.getDate());
    	var y = finalDate.getFullYear().toString().substr(-2);
    	var fecha = (m+"/"+d+"/"+y);
 			arrayDias.push(fecha);
 			finalDate.setDate(finalDate.getDate()-1)
 		}

 		axios.get('https://corona.lmao.ninja/v2/historical/Mexico?lastdays=30')
      .then(function (response) {
       	var dataGrafica = response.data;
       	for (var i = 0; i <= 4; i++) {
       		arrayConfirmados.push(dataGrafica.timeline.cases[arrayDias[i]]);
       		arrayRecuperados.push(dataGrafica.timeline.recovered[arrayDias[i]]);
       		arrayfallecidos.push(dataGrafica.timeline.deaths[arrayDias[i]]);
       		//console.log(dataGrafica.timeline.cases[arrayDias[i]]);
       	}

       	dataC = arrayConfirmados;
		    dataR = arrayRecuperados;
		   	dataF = arrayfallecidos;

       	var ctx = document.getElementById('myChart').getContext('2d');   
				var myChart = new Chart(ctx, {
				    type: 'bar',
				    data: {
				        labels: arrayDias,
				        datasets: [{
				            label: 'Confirmados',
				            data: dataC,
				            backgroundColor: [
				                'rgba(255, 99, 132, 0.9)',
				            ],
				            borderColor: [
				                'rgba(255, 99, 132, 0.9)',
				            ],
				            borderWidth: 1
				        },{
				        	label: 'Recuperados',
				            data: dataR,
				            backgroundColor: [
				                'rgba(75, 192, 192, 0.9)',
				            ],
				            borderColor: [
				                'rgba(75, 192, 192, 0.9)',
				            ],
				            borderWidth: 1
				        },{
				        	label: 'Fallecidos',
				            data: dataF,
				            backgroundColor: [
				                'rgba(201, 203, 207, 0.9)',
				            ],
				            borderColor: [
				                'rgba(201, 203, 207, 0.9)',
				            ],
				            borderWidth: 1}],
				    },
				    options: {
				        scales: {
				            y: {
				                beginAtZero: true
				            }
				        }
				    }
					});
  			})
	      	.catch(function (error) { 
	      		console.log(error);
  			});

		axios.get('https://corona.lmao.ninja/v2/countries/Mexico?yesterday&strict&query%20')
      .then(function (response) { 
        var data = response.data;
        document.getElementById("confirmados").innerHTML = data.cases;
        document.getElementById("moridos").innerHTML = data.deaths;
        document.getElementById("recuperados").innerHTML = data.recovered;
    })
      .catch(function (error) { 
        console.log(error);
    });
	</script>
</body>
</html>
